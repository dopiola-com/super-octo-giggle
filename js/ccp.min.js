"use strict";jQuery.support.cors=!0;var ccp_configErrorStatus="jsConfigError";function ccp_getServerIsDownError(){var e={status:31,statusText:"SERVER_IS_DOWN",data:"server is most likely offline or unknown ajax error occured"};return e}function ccp_getNoDataError(){var e={status:34,statusText:"NO_DATA",data:"caller did not provide data"};return e}function ccp_getNoKeysSetError(){var e={status:35,statusText:"NO_KEYS_SET",data:"no keys set in session"};return e}function ccp_getJsBusyError(){var e={status:37,statusText:"JS_BUSY",data:"JavaScript library is processing another request"};return e}function ccp_getFullScreenNotSupportedError(){var e={status:38,statusText:"FULL_SCREEN_NOT_SUPPORTED",data:"Full screen is not supported on this system"};return e}function CCPSignLibCore(){this.sessionIsOpening=!1,this.sessionId=null,this.userServerPort=null,this.getResultIsRunning=!1,this.askForAlive=!1,this.getUserServerPortSend=!1,this.keepAliveFailureCount=0,this.localJsStore=[],this.callbackList=[],this.version="2.3.0",this.sessionIdHeaderName="X-CCP-sessionId",this.cmdIdHeaderName="X-CCP-cmdId",this.dataType="text",this.serverAddress="https://localhost",this.dispatcherPort=8630,this.dllModule="",this.userServerPortStartValue=null,this.ajaxTimeout=1e4,this.getUserServerPortTimeout=5e3,this.callLoopInterval=1e3,this.requestMethod="POST",this.getResultTimeout=5e3,this.getResultInterval=1e3,this.keepAliveTimeout=5e3,this.keepAliveInterval=1e3,this.keepAliveMaxFailures=3,this.ajaxGetLogsTimeout=6e4,this.ajaxTestFunTimeout=2e4,this.httpOK=200,this.httpAccepted=202,this.httpBadRequest=400,this.httpForbidden=403,this.httpNotFound=404,this.httpNoSession=418,this.httpNoResult=419,this.httpInternalServerError=500,this.httpServiceUnavailableReason=503,this.lastError={},this.lastError.status=31,this.lastError.statusText="SERVER_IS_DOWN",this.lastError.data="server is most likely offline or unknown ajax error occured"}function CCPCover(){this.enabled=!0,this.coverDivId="CCP_CoverDiv",this.progressGif="../static/img/infoBox/preloader.gif",this.progressAlt="Trwa ładowanie",this.progressTitle="Trwa ładowanie",this.progressDescription="Proszę czekać",this.progressDescriptionColor="white"}function CCPSignLib(){this.cover=new CCPCover,this.resultDelimiter="|",this.errorCodeColumn=0,this.datailColumn=2,this.errorCodeOK=0,this.version="2.3.0";var e="Unknown OS",t=window.navigator.appVersion;-1!==t.indexOf("Win")&&(e="Windows"),-1!==t.indexOf("Mac")&&(e="MacOS"),-1!==t.indexOf("X11")&&(e="UNIX"),-1!==t.indexOf("Linux")&&(e="Linux"),this.OSName=e}function CCPUpdaterModuleSystem(){this.core=new CCPSignLibCore,this.core.dllModule="updater",this.errorCodeConnectionError=45,this.errorCodeProxySet=46,this.core.setUserServerPortStartValue(this.core.dispatcherPort)}function CCPUpdaterModuleUser(){this.core=new CCPSignLibCore,this.core.dllModule="updater",this.errorCodeConnectionError=45,this.errorCodeProxySet=46}function CCPUpdaterLib(){CCPSignLib.call(this),this.updaterModule=new CCPUpdaterModuleSystem,this.updaterModuleCore=this.updaterModule.core,this.updaterModuleUser=new CCPUpdaterModuleUser,this.updaterModuleUserCore=this.updaterModuleUser.core}function CCPConfigurationVerifierLib(){CCPUpdaterLib.call(this)}function CCPPekaoModule(){this.core=new CCPSignLibCore,this.core.dllModule="pekao"}function SignLibPekao(){CCPConfigurationVerifierLib.call(this),this.pekaoModule=new CCPPekaoModule,this.pekaoModuleCore=this.pekaoModule.core}CCPSignLibCore.prototype.getLastError=function(){var e={};return e.status=this.lastError.status,e.statusText=this.lastError.statusText,e.data=this.lastError.data,e},CCPSignLibCore.prototype.objectToJsonString=function(e){if("undefined"!=typeof JSON&&void 0!==JSON.stringify)return JSON.stringify(e);var t,r,i,o=typeof e,s=[];if("object"!==o||null===e)return"string"===o&&(e='"'+e.replace(/\"/g,'\\"')+'"'),String(e);for(t in i=e&&e.constructor===Array,e)e.hasOwnProperty(t)&&("string"===(o=typeof(r=e[t]))?r='"'+r.replace(/\"/g,'\\"')+'"':"object"===o&&null!==r&&(r=this.objectToJsonString(r)),s.push((i?"":'"'+t+'":')+String(r)));return(i?"[":"{")+String(s)+(i?"]":"}")},CCPSignLibCore.prototype.jsonStringToObject=function(e){return $.parseJSON(e)},CCPSignLibCore.prototype.isEmpty=function(e){return null==e||e.length<=0},CCPSignLibCore.prototype.notDefined=function(e){return null==e},CCPSignLibCore.prototype.convertResultToJson=function(t){var r,i,t=this.notDefined(t.data)?(i=t,-1):(i=t.data,t.status);if("object"==typeof i)return this.objectToJsonString(i);if("string"!=typeof i)return i===parseInt(i,10)?(r={}).resultCode=i:((r={}).resultCode=t,r.messageShort=i),this.objectToJsonString(r);try{return r=this.jsonStringToObject(i),i}catch(e){return r={},i=i.split("|"),isNaN(i[0])||this.isEmpty(i[0])?(r.resultCode=t,r.messageShort=i[0],1<i.length&&(r.messageLong=i[1])):(r.resultCode=parseInt(i[0],10),1<i.length&&(r.messageShort=i[1]),2<i.length&&(r.messageLong=i[2])),this.objectToJsonString(r)}},CCPSignLibCore.prototype.convertResultToObject=function(t){var r;if("object"==typeof t)return t;if("string"!=typeof t)return t===parseInt(t,10)?(r={}).resultCode=t:(r={resultCode:-1}).messageShort=t,r;try{return r=this.jsonStringToObject(t)}catch(e){return r={},t=t.split("|"),isNaN(t[0])?(r.resultCode=-1,r.messageShort=t[0],1<t.length&&(r.messageLong=t[1])):(r.resultCode=parseInt(t[0],10),1<t.length&&(r.messageShort=t[1]),2<t.length&&(r.messageLong=t[2])),r}},CCPSignLibCore.prototype.convertResultToPipe=function(t){var e,r="";if("object"==typeof t)return r+=t.resultCode,this.isEmpty(t.messageShort)||(r+="|"+t.messageShort),this.isEmpty(t.messageLong)||(r+="|"+t.messageLong),r;if("string"!=typeof t)return t.toString();try{return r+=(e=this.jsonStringToObject(t)).resultCode,this.isEmpty(e.messageShort)||(r+="|"+e.messageShort),this.isEmpty(e.messageLong)||(r+="|"+e.messageLong),r}catch(e){return t}},CCPSignLibCore.prototype.createServerUrl=function(e,t,r,i){return null===t&&(t=0),this.isEmpty(r)?e+":"+t+"/"+i:e+":"+t+"/"+r+"/"+i},CCPSignLibCore.prototype.isSessionOpen=function(){return!this.isEmpty(this.sessionId)},CCPSignLibCore.prototype.isSessionStillOpenning=function(){return!!this.sessionIsOpening},CCPSignLibCore.prototype.processServerIsDown=function(){this.askForAlive=!1,this.sessionId=null,this.userServerPort=this.userServerPortStartValue,this.keepAliveFailureCount=0,this.sessionIsOpening=!1},CCPSignLibCore.prototype.setUserServerPortStartValue=function(e){this.userServerPortStartValue=e,this.userServerPort=e},CCPSignLibCore.prototype.prepareAndCallAjax=function(e,t,r){var i={};i.restParams=e,i.callBackFunction=t,i.cancelled=!1,this.prepareAndCallAjaxInner(i,r)},CCPSignLibCore.prototype.prepareAndCallAjaxInner=function(e,t,r){!this.setServerConnectionAndSession(e,t)||null!==(r=void 0!==r?r:this.prepareAjaxRequest(e,t))&&this.callAjaxRequest(r,e)},CCPSignLibCore.prototype.setServerConnectionAndSession=function(e,t){return!0!==e.cancelled&&(null!==this.userServerPort&&null!==this.sessionId||(this.isSessionStillOpenning()||(null===this.userServerPort?this.getUserServerPort(e):this.openSession(this.userServerPort,e)),r=this,i=e,o=t,setTimeout(function(){r.prepareAndCallAjaxInner(i,o)},this.callLoopInterval),!1));var r,i,o},CCPSignLibCore.prototype.prepareAjaxRequest=function(e,t){var r,i,o,s,n,a,d,p,l,u=e.restParams,c=e.callBackFunction,h={},C=(new Date).getTime();if(void 0===t&&(t=this.ajaxTimeout),h.cmdId=C,this.isSessionOpen())r=this,i=C,h.beforeSend=function(e){e.setRequestHeader(r.sessionIdHeaderName,r.sessionId),e.setRequestHeader(r.cmdIdHeaderName,i)};else if(this.isSessionStillOpenning())return c(ccp_getJsBusyError()),null;return h.type=this.requestMethod,h.timeout=t,h.cache=!1,h.dataType=this.dataType,this.isEmpty(u.params)?h.data="":h.data=u.params,h.cmd=u.cmd,o=this,n=c,(s=h).success=function(e,t,r){o.onAjaxSuccess(e,t,r,s,n)},a=this,p=c,l=e,(d=h).error=function(e,t,r){a.onAjaxError(e,t,r,d,p,l)},h},CCPSignLibCore.prototype.onAjaxSuccess=function(e,t,r,i,o){var s;r.status===this.httpOK?((s={}).status=r.status,s.statusText=r.statusText,s.data=e,o(s)):r.status===this.httpAccepted&&(i.sessionId=this.sessionId,this.setCallback(i,o))},CCPSignLibCore.prototype.onAjaxError=function(e,t,r,i,o,s){var n;switch(e.status){case this.httpBadRequest:case this.httpForbidden:case this.httpNotFound:case this.httpInternalServerError:this.processServerIsDown(),(n={}).status=e.status,n.statusText=e.statusText,n.data=e.responseText,o(n);break;case this.httpServiceUnavailableReason:(n={}).status=e.status,n.statusText=e.statusText,n.data=e.responseText,o(n);break;case this.httpNoSession:this.processServerIsDown(),this.prepareAndCallAjaxInner(s,i.timeout,i);break;default:this.processServerIsDown(),o(this.getLastError())}},CCPSignLibCore.prototype.callAjaxRequest=function(e,t){t=t.callBackFunction;if(this.isSessionStillOpenning())t(ccp_getJsBusyError());else{if(this.userServerPort<=0)return this.userServerPort=null,void t(ccp_getServerIsDownError());e.url=this.createServerUrl(this.serverAddress,this.userServerPort,this.dllModule,e.cmd),jQuery.ajax(e)}},CCPSignLibCore.prototype.getUserServerPort=function(e){var t,i,o,s;!1===this.getUserServerPortSend&&(this.getUserServerPortSend=!0,(t={}).url=this.createServerUrl(this.serverAddress,this.dispatcherPort,"","GET_USER_SERVER_PORT"),t.type=this.requestMethod,t.timeout=this.getUserServerPortTimeout,t.cache=!1,t.dataType=this.dataType,t.data="",o=this,s=e,t.success=function(e,t,r){o.onUserServerPortSuccess(e,t,r,s)},i=this,t.error=function(e,t,r){i.onUserServerPortError(e,t,r)},jQuery.ajax(t))},CCPSignLibCore.prototype.onUserServerPortSuccess=function(e,t,r,i){r.status!==this.httpOK||this.isEmpty(e)?(this.userServerPort=0,this.sessionId=0,this.sessionIsOpening=!1):this.userServerPort=e,this.getUserServerPortSend=!1},CCPSignLibCore.prototype.onUserServerPortError=function(e,t,r){0!==e.status?(this.lastError.status=e.status,this.lastError.statusText=e.statusText,this.lastError.data=e.responseText):this.lastError=ccp_getServerIsDownError(),this.userServerPort=0,this.sessionId=0,this.sessionIsOpening=!1,this.getUserServerPortSend=!1},CCPSignLibCore.prototype.openSession=function(e,t){this.sessionIsOpening=!0;var i,o,s,n,a,r={};r.url=this.createServerUrl(this.serverAddress,e,"","OPEN_SESSION"),r.type=this.requestMethod,r.timeout=this.ajaxTimeout,r.cache=!1,r.dataType=this.dataType,r.data={},r.data.sessionVars=this.localJsStoreToString(),i=this,o=e,s=t,r.success=function(e,t,r){i.onOpenSessionSuccess(e,t,r,o,s)},n=this,a=t,r.error=function(e,t,r){n.onOpenSessionError(e,t,r,a)},jQuery.ajax(r)},CCPSignLibCore.prototype.onOpenSessionSuccess=function(e,t,r,i,o){var s;r.status!==this.httpOK||this.isEmpty(e)?(this.processServerIsDown(),s={},0!==r.status?(s.status=r.status,s.statusText=r.statusText,s.data=e):s=this.getLastError(),o.callBackFunction(s),o.cancelled=!0):(r=e,this.isSessionOpen()||this.isEmpty(r)||(this.sessionId=r,this.startKeepAlive(),!1===this.getResultIsRunning&&this.startGetResult()),this.userServerPort=i),this.sessionIsOpening=!1},CCPSignLibCore.prototype.onOpenSessionError=function(e,t,r,i){this.processServerIsDown();var o={};0!==e.status?(o.status=e.status,o.statusText=e.statusText,o.data=e.responseText):o=this.getLastError(),i.callBackFunction(o),i.cancelled=!0},CCPSignLibCore.prototype.startGetResult=function(){var e;this.getResultIsRunning=!0,e=this,setTimeout(function(){e.getResults()},this.getResultInterval)},CCPSignLibCore.prototype.getResults=function(){var e,t,r,i,o,s=function(t,r,i){return function(e){e.setRequestHeader(t.sessionIdHeaderName,r),e.setRequestHeader(t.cmdIdHeaderName,i)}},n=function(i,o){return function(e,t,r){i.onGetResultSuccess(e,t,r,o)}},a=function(i,o){return function(e,t,r){i.onGetResultError(e,t,r,o)}};if(null!==this.userServerPort)for(o=0;o<this.callbackList.length;o+=1)t=(e=this.callbackList[o].ajaxRequest).cmdId,r=this.sessionId,i={},this.isEmpty(e.sessionId)||(r=e.sessionId),i.url=this.createServerUrl(this.serverAddress,this.userServerPort,this.dllModule,"GET_RESULT"),i.type=this.requestMethod,i.timeout=this.getResultTimeout,i.cache=!1,i.dataType=this.dataType,i.data="",i.beforeSend=s(this,r,t),i.success=n(this,t),i.error=a(this,t),jQuery.ajax(i);this.startGetResult()},CCPSignLibCore.prototype.onGetResultSuccess=function(e,t,r,i){var o;r.status===this.httpOK&&((o={}).status=r.status,o.statusText=r.statusText,o.data=e,this.callbackFunction(i,o))},CCPSignLibCore.prototype.onGetResultError=function(e,t,r,i){var o;e.status!==this.httpNoSession&&e.status!==this.httpForbidden||this.processServerIsDown(),0!==e.status?((o={}).status=e.status,o.statusText=e.statusText,o.data=e.responseText,this.callbackFunction(i,o)):(this.processServerIsDown(),e=this.getLastError(),this.callbackFunction(i,e))},CCPSignLibCore.prototype.startKeepAlive=function(){var e;this.askForAlive=!0,e=this,setTimeout(function(){e.keepAlive()},this.keepAliveInterval)},CCPSignLibCore.prototype.keepAlive=function(){var t,i,o,e={};this.isSessionOpen()&&!1!==this.askForAlive&&(e.url=this.createServerUrl(this.serverAddress,this.userServerPort,this.dllModule,"ALIVE"),e.type=this.requestMethod,e.timeout=this.keepAliveTimeout,e.cache=!1,e.dataType=this.dataType,e.data={},t=this,e.beforeSend=function(e){e.setRequestHeader(t.sessionIdHeaderName,t.sessionId)},i=this,e.success=function(e,t,r){i.onKeepAliveSuccess(e,t,r)},o=this,e.error=function(e,t,r){o.onKeepAliveError(e,t,r)},jQuery.ajax(e),this.startKeepAlive())},CCPSignLibCore.prototype.onKeepAliveSuccess=function(e,t,r){r.status===this.httpOK&&(this.keepAliveFailureCount=0)},CCPSignLibCore.prototype.onKeepAliveError=function(e,t,r){e.status===this.httpNoSession?this.processServerIsDown():(this.keepAliveFailureCount+=1,this.keepAliveFailureCount>=this.keepAliveMaxFailures&&(this.askForAlive=!1),!1===this.askForAlive&&this.processServerIsDown())},CCPSignLibCore.prototype.isLocalKeySet=function(e){for(var t=0;t<this.localJsStore.length;t+=1)if(this.localJsStore[t].key===e)return t;return-1},CCPSignLibCore.prototype.saveInLocalJsStore=function(e,t){var r=this.isLocalKeySet(e),i={};i.key=e,i.value=t,r<0&&(r=this.localJsStore.push(i)-1),this.localJsStore[r]=i},CCPSignLibCore.prototype.localJsStoreToString=function(){return this.objectToJsonString(this.localJsStore)},CCPSignLibCore.prototype.setCallback=function(e,t){var r=e.cmdId,i={};return-1===this.isCallbackSet(r)&&(i.ajaxRequest=e,i.callback=t,this.callbackList.push(i),!0)},CCPSignLibCore.prototype.isCallbackSet=function(e){for(var t=0;t<this.callbackList.length;t+=1)if(this.callbackList[t].ajaxRequest.cmdId===e)return t;return-1},CCPSignLibCore.prototype.getCallback=function(e){e=this.isCallbackSet(e);if(-1!==e)return this.callbackList[e].callback},CCPSignLibCore.prototype.removeCallback=function(e){e=this.isCallbackSet(e);-1!==e&&this.callbackList.splice(e,1)},CCPSignLibCore.prototype.callbackFunction=function(e,t){var r=this.getCallback(e);this.isEmpty(r)||(this.removeCallback(e),r(t))},CCPSignLibCore.prototype.setSessionVar=function(e,t,r){var i={cmd:"SET_SESSION_VAR",params:{}};i.params.key=e,i.params.value=t,this.prepareAndCallAjax(i,r),this.saveInLocalJsStore(e,t)},Object.create||(Object.create=function(e,t){if("object"!=typeof e&&"function"!=typeof e)throw new TypeError("Object prototype may only be an Object: "+e);if(null===e)throw new Error("This browser's implementation of Object.create is a shim and doesn't support 'null' as the first argument.");if(void 0!==t)throw new Error("This browser's implementation of Object.create is a shim and doesn't support a second argument.");function r(){}return r.prototype=e,new r}),CCPCover.prototype.getFrameDocument=function(){for(var e,t,r=window.parent.frames,i=0;i<r.length;i+=1)"main"===r[i].name&&(t=r[i]);return e=(t=0<r.length?r[0]:t)?t.document:e},CCPCover.prototype.getCoverDiv=function(e){var t;return t=e?e.getElementById(this.coverDivId):t},CCPCover.prototype.coverPage=function(){var e,t,r;this.enabled&&(e=this.getFrameDocument(),t=this.getCoverDiv(e),r=null,e&&(r=e.getElementsByTagName("BODY")),t?t.style.display="block":r&&0!==r.length&&this.createCoverDiv(e),this.relocateCoverDiv())},CCPCover.prototype.createProgressIndicator=function(e,t){var r=e.createElement("div");t.appendChild(r),r.style.zIndex="2100",r.style.position="absolute",r.style.top="50%",r.style.left="50%",r.style.textAlign="center",t=e.createElement("img"),r.appendChild(t),t.src=this.progressGif,t.alt=this.progressAlt,t.title=this.progressTitle,t=e.createElement("br"),r.appendChild(t),t=e.createElement("p"),r.appendChild(t),t.innerHTML=this.progressDescription,t.style.color=this.progressDescriptionColor},CCPCover.prototype.createCoverDiv=function(e){var t,r=e.createElement("div");e.body.appendChild(r),this.createProgressIndicator(e,r),r.id=this.coverDivId,r.style.display="block",r.style.position="fixed",r.style.top="0",r.style.left="0",r.style.width="100%",r.style.height="100%",r.style.backgroundColor="white",r.style.MozOpacity="0.8",r.style.opacity=".80",r.style.filter="alpha(opacity=80)",r.style.zIndex="2099",t=this,e=function(){t.relocateCoverDiv()},$(window).scroll(e)},CCPCover.prototype.relocateCoverDiv=function(){var e,t,r=this.getFrameDocument(),r=this.getCoverDiv(r);r&&(e=window.pageYOffset,t=window.pageXOffset,r.top=e,r.left=t)},CCPCover.prototype.uncoverPage=function(){var e;this.enabled&&(e=this.getFrameDocument(),(e=this.getCoverDiv(e))&&(e.style.display="none"))},CCPSignLib.prototype.getModuleCore=function(){},CCPSignLib.prototype.getInnerCallback=function(t){return r=this,function(e){e=r.convertResult(e,r.mapStatusCode);r.getModuleCore().callbackList.length<=0&&r.updaterModuleCore.callbackList.length<=0&&r.updaterModuleUserCore.callbackList.length<=0&&r.cover.uncoverPage(),t(e)};var r},CCPSignLib.prototype.mapStatusCode=function(e,t){return e},CCPSignLib.prototype.isFullScreenSuported=function(){return"MacOS"!==this.OSName||window.outerHeight!==window.screen.height||window.outerWidth!==window.screen.width},CCPSignLib.prototype.convertResult=function(e,t){var r,i,o,s=!0;return e.status===this.getModuleCore().httpOK&&1<e.data.split(this.resultDelimiter).length&&(s=!1),o=e.data,s?(i=t(e.status,this),s=e.statusText,r=i.toString(),e.status!==this.getModuleCore().httpOK&&s&&(r=r+this.resultDelimiter+s),o&&(r=r+this.resultDelimiter+o)):(i=t(this.getErrorCodeFromTextResult(o),this),e=o.indexOf(this.resultDelimiter),r=i.toString()+o.substr(e)),r},CCPSignLib.prototype.getErrorCodeFromTextResult=function(e){e=e.split(this.resultDelimiter)[this.errorCodeColumn];return parseInt(e,10)},CCPSignLib.prototype.getDetailFromTextResult=function(e){return e.split(this.resultDelimiter)[this.datailColumn]},CCPSignLib.prototype.getArchType=function(e){var t;this.cover.coverPage(),e=this.getInnerCallback(e),t={cmd:"ARCH_TYPE",params:{}},this.getModuleCore().prepareAndCallAjax(t,e)},CCPSignLib.prototype.setLanguage=function(e,t){this.cover.coverPage(),t=this.getInnerCallback(t),this.getModuleCore().setSessionVar("languageId",e,t)},CCPSignLib.prototype.getServerVersion=function(e){this.cover.coverPage();var e=this.getInnerCallback(e),t={cmd:"SERVER_VERSION",params:{}};this.getModuleCore().prepareAndCallAjax(t,e)},CCPSignLib.prototype.closeSession=function(e){this.cover.coverPage();var e=this.getInnerCallback(e),t={cmd:"CLOSE_SESSION",params:{}};this.getModuleCore().prepareAndCallAjax(t,e)},CCPUpdaterLib.prototype=Object.create(CCPSignLib.prototype),(CCPUpdaterLib.prototype.constructor=CCPUpdaterLib).prototype.getInnerCallbackUpdater=function(t){return r=this,function(e){e=r.convertResult(e,r.mapUpdaterStatusCode);r.getModuleCore().callbackList.length<=0&&r.updaterModuleCore.callbackList.length<=0&&r.updaterModuleUserCore.callbackList.length<=0&&r.cover.uncoverPage(),t(e)};var r},CCPUpdaterLib.prototype.mapUpdaterStatusCode=function(e,t){t={200:t.errorCodeOK,202:t.errorCodeOK,400:1,403:1,404:1,418:1,419:1,500:51,503:51,0:t.errorCodeOK,41:41,42:42,43:43,44:44,45:45,46:46,47:47,31:-1,34:1,37:1}[e];return t=void 0===t?e:t},CCPUpdaterLib.prototype.closeUpdaterSystemSession=function(e){this.cover.coverPage();var e=this.getInnerCallbackUpdater(e),t={cmd:"CLOSE_SESSION",params:{}};this.updaterModuleCore.prepareAndCallAjax(t,e)},CCPUpdaterLib.prototype.startUpdate=function(e,t,r,i){this.cover.coverPage();var o=this,s=this.getInnerCallbackUpdater(function(t){o.closeUpdaterSystemSession(function(e){i(t)})}),n={cmd:"Update",params:{}};this.getModuleCore().isEmpty(e)||this.getModuleCore().isEmpty(t)?s(ccp_getNoDataError()):("string"==typeof e?n.params.url=e:n.params=e,n.params.destFileName=t,n.params.proxySettings=r,this.updaterModuleCore.prepareAndCallAjax(n,s))},CCPUpdaterLib.prototype.showConnectionWarning=function(e,t){this.cover.coverPage();var t=this.getInnerCallbackUpdater(t),r={cmd:"ShowConnectionWarning",params:{}};""===e?t(ccp_getNoDataError()):(r.params.connectionErrorCode=e,this.updaterModuleUserCore.prepareAndCallAjax(r,t))},CCPUpdaterLib.prototype.doUpdate=function(t,r,e){var i,n,a,d,p,l,u,o=this;d=this,p=t,l=r,u=e,i=function(e){var t,r,i,o,s;d.getErrorCodeFromTextResult(e)===d.updaterModule.errorCodeConnectionError?(i=p,o=l,s=u,t=function(e){r.getErrorCodeFromTextResult(e)!==r.updaterModuleUser.errorCodeProxySet?s(e):(n=r.getDetailFromTextResult(e),r.startUpdate(i,o,n,s))},a=(r=d).getDetailFromTextResult(e),d.showConnectionWarning(a,t)):u(e)},o.closeSession(function(e){o.startUpdate(t,r,"",i)})},CCPConfigurationVerifierLib.prototype=Object.create(CCPUpdaterLib.prototype),(CCPConfigurationVerifierLib.prototype.constructor=CCPConfigurationVerifierLib).prototype.errorCodeNotInstalled=-1,CCPConfigurationVerifierLib.prototype.errorCodeUnsupportedBrowser=21,CCPConfigurationVerifierLib.prototype.errorCodeNeedUpdate=22,CCPConfigurationVerifierLib.prototype.errorCodeUpdateFailed=23,CCPConfigurationVerifierLib.prototype.errorCodeNeedRelogin=24,CCPConfigurationVerifierLib.prototype.isBrowserSupported=function(e){var t=navigator.userAgent.toLowerCase(),r=parseInt(navigator.appVersion,10),i=(parseFloat(navigator.appVersion),-1!==t.indexOf("mozilla")&&-1===t.indexOf("spoofer")&&-1===t.indexOf("compatible")&&-1===t.indexOf("opera")&&-1===t.indexOf("webtv")&&-1===t.indexOf("hotjava")),i=(!i||-1===t.indexOf(";nav")&&t.indexOf("; nav"),t.indexOf("gecko"),(-1!==t.indexOf("msie")||-1!==t.indexOf("trident"))&&-1===t.indexOf("opera")),o=i&&r<4,s=i&&4===r&&-1!==t.indexOf("msie 4"),n=i&&4===r&&-1!==t.indexOf("msie 5.0"),a=i&&4===r&&-1!==t.indexOf("msie 5.5"),d=(i&&4===r&&t.indexOf("msie 6."),i&&-1!==t.indexOf("msie 7.")),i=(i&&t.indexOf("msie 8."),!(!i||o||s||n||a||d)),o=(t.indexOf("aol"),t.indexOf("aol 5"),t.indexOf("aol 6"),-1!==t.indexOf("opera/")||-1!==t.indexOf("opr/")),s=o&&-1!==t.indexOf("version/2.")||-1!==t.indexOf("opr/2.")||-1!==t.indexOf("opera 2."),n=o&&-1!==t.indexOf("version/3.")||-1!==t.indexOf("opr/3.")||-1!==t.indexOf("opera 3."),a=o&&-1!==t.indexOf("version/4.")||-1!==t.indexOf("opr/4.")||-1!==t.indexOf("opera 4."),d=(o&&-1!==t.indexOf("version/5.")||-1!==t.indexOf("opr/5.")||t.indexOf("opera 5."),o&&!s&&!n&&!a),s=o&&-1!==t.indexOf("version/6.")||-1!==t.indexOf("opr/6.")||-1!==t.indexOf("opera 6."),n=o&&-1!==t.indexOf("version/7.")||-1!==t.indexOf("opr/7.")||-1!==t.indexOf("opera 7."),a=o&&-1!==t.indexOf("version/8.")||-1!==t.indexOf("opr/8.")||-1!==t.indexOf("opera 8."),p=o&&-1!==t.indexOf("version/9.")||-1!==t.indexOf("opr/9.")||-1!==t.indexOf("opera 9."),d=(o&&-1!==t.indexOf("version/10.")||-1!==t.indexOf("opr/10.")||t.indexOf("opera 10."),d&&!s&&!n&&!a&&!p),s=o&&-1!==t.indexOf("version/11.")||-1!==t.indexOf("opr/11.")||-1!==t.indexOf("opera 11."),n=o&&-1!==t.indexOf("version/12.")||-1!==t.indexOf("opr/12."),a=o&&-1!==t.indexOf("version/13.")||-1!==t.indexOf("opr/13."),p=o&&-1!==t.indexOf("version/14.")||-1!==t.indexOf("opr/14."),o=(o&&-1!==t.indexOf("version/15.")||t.indexOf("opr/15."),d&&!s&&!n&&!a&&!p),d=-1!==t.indexOf("edge"),s=-1!==t.indexOf("chrome")&&-1===t.indexOf("opr/")&&-1===t.indexOf("edge"),n=-1!==t.indexOf("chrome 0.")||-1!==t.indexOf("chrome/0."),a=-1!==t.indexOf("chrome 1.")||-1!==t.indexOf("chrome/1."),p=-1!==t.indexOf("chrome 2.")||-1!==t.indexOf("chrome/2."),l=-1!==t.indexOf("chrome 3.")||-1!==t.indexOf("chrome/3."),u=-1!==t.indexOf("chrome 4.")||-1!==t.indexOf("chrome/4."),c=-1!==t.indexOf("chrome 5.")||-1!==t.indexOf("chrome/5."),h=-1!==t.indexOf("chrome 6.")||-1!==t.indexOf("chrome/6."),C=-1!==t.indexOf("chrome 7.")||-1!==t.indexOf("chrome/7."),f=-1!==t.indexOf("chrome 8.")||-1!==t.indexOf("chrome/8."),g=-1!==t.indexOf("chrome 9.")||-1!==t.indexOf("chrome/9."),x=-1!==t.indexOf("chrome 10.")||-1!==t.indexOf("chrome/10."),S=-1!==t.indexOf("chrome 11.")||-1!==t.indexOf("chrome/11."),v=-1!==t.indexOf("chrome 12.")||-1!==t.indexOf("chrome/12."),O=-1!==t.indexOf("chrome 13.")||-1!==t.indexOf("chrome/13."),m=-1!==t.indexOf("chrome 14.")||-1!==t.indexOf("chrome/14."),y=-1!==t.indexOf("chrome 15.")||-1!==t.indexOf("chrome/15."),b=-1!==t.indexOf("chrome 16.")||-1!==t.indexOf("chrome/16."),P=-1!==t.indexOf("chrome 17.")||-1!==t.indexOf("chrome/17."),L=-1!==t.indexOf("chrome 18.")||-1!==t.indexOf("chrome/18."),s=!(!!(!s||n||a||p||l||u||c||h||C||f||g)||x||S||v||O||m||y||b||P||L),n=-1!==t.indexOf("safari")&&-1===t.indexOf("chrome"),a=(n&&t.indexOf("version"),n&&-1!==t.indexOf("version/3")),p=n&&-1!==t.indexOf("version/4"),l=n&&-1!==t.indexOf("version/5"),u=n&&-1!==t.indexOf("version")&&!a&&!p&&!l,c=(/^((?!chrome).)*safari/i.test(t),t.indexOf("webtv"),-1===t.indexOf("navio")&&t.indexOf("navio_aoltv"),t.indexOf("hotjava"),-1!==t.indexOf("firefox")),h=(-1===t.indexOf("firefox 3.6")&&t.indexOf("firefox/3.6"),-1!==t.indexOf("firefox 1.")||-1!==t.indexOf("firefox/1.")||-1!==t.indexOf("firefox 2.")||-1!==t.indexOf("firefox/2.")||-1!==t.indexOf("firefox 3.0")||-1!==t.indexOf("firefox/3.0")||-1!==t.indexOf("firefox 3.1")||-1!==t.indexOf("firefox/3.1")||-1!==t.indexOf("firefox 3.2")||-1!==t.indexOf("firefox/3.2")||-1!==t.indexOf("firefox 3.3")||-1!==t.indexOf("firefox/3.3")||-1!==t.indexOf("firefox 3.4")||-1!==t.indexOf("firefox/3.4")),C=(h||-1!==t.indexOf("firefox 3.5")||t.indexOf("firefox/3.5"),c&&!h),f=(-1===t.indexOf("win")&&t.indexOf("16bit"),-1!==t.indexOf("win95")||-1!==t.indexOf("windows 95")),g=(-1===t.indexOf("win16")&&-1===t.indexOf("16bit")&&-1===t.indexOf("windows 3.1")&&t.indexOf("windows 16-bit"),-1===t.indexOf("windows 3.1")&&-1===t.indexOf("win16")&&t.indexOf("windows 16-bit"),t.indexOf("win 9x 4.90"),t.indexOf("windows nt 5.0"),-1!==t.indexOf("win98")||-1!==t.indexOf("windows 98")),x=-1!==t.indexOf("winnt")||-1!==t.indexOf("windows nt"),S=(f||x||g||4<=r&&"Win32"===navigator.platform||-1!==t.indexOf("win32")||t.indexOf("32bit"),4<=r&&"Win64"===navigator.platform||4<=r&&"wow64"===navigator.platform||-1!==t.indexOf("wow64")||-1!==t.indexOf("x64")||-1!==t.indexOf("win64")||t.indexOf("64bit"),-1===t.indexOf("os/2")&&-1===navigator.appVersion.indexOf("OS/2")&&t.indexOf("ibm-webexplorer"),-1!==t.indexOf("mac")),v=(S&&/os x (\d{1}[\._]|10[\._][0-5])/.test(t),!S||-1===t.indexOf("68k")&&t.indexOf("68000"),!S||-1===t.indexOf("ppc")&&t.indexOf("powerpc"),-1!==t.indexOf("sunos")),O=(t.indexOf("sunos 4"),t.indexOf("sunos 5"),v&&t.indexOf("i86"),t.indexOf("irix"),t.indexOf("irix 5"),-1===t.indexOf("irix 6")&&t.indexOf("irix6"),-1!==t.indexOf("hp-ux")),m=(O&&t.indexOf("09."),O&&t.indexOf("10."),t.indexOf("aix"),t.indexOf("aix 1"),t.indexOf("aix 2"),t.indexOf("aix 3"),t.indexOf("aix 4"),t.indexOf("inux"),-1===t.indexOf("sco")&&t.indexOf("unix_sv"),t.indexOf("unix_system_v"),t.indexOf("ncr"),t.indexOf("reliantunix"),-1===t.indexOf("dec")&&-1===t.indexOf("osf1")&&-1===t.indexOf("dec_alpha")&&-1===t.indexOf("alphaserver")&&-1===t.indexOf("ultrix")&&t.indexOf("alphastation"),t.indexOf("sinix"),t.indexOf("freebsd"),t.indexOf("bsd"),t.indexOf("x11"),-1===t.indexOf("vax")&&t.indexOf("openvms"),i||C||s||d||u||o?this.errorCodeOK:this.errorCodeUnsupportedBrowser);e(m)},CCPConfigurationVerifierLib.prototype.compareVersions=function(e,t,r){var i,o,s,n,a,d,p,l=0;for("string"==typeof t?i=t:-1!==r[0].toLowerCase().indexOf("win")&&-1!==r[2].toLowerCase().indexOf("i386")?i=t.ver_win32:-1!==r[0].toLowerCase().indexOf("linux")&&-1!==r[2].toLowerCase().indexOf("i386")?i=t.ver_lin32:-1!==r[0].toLowerCase().indexOf("linux")&&-1!==r[2].toLowerCase().indexOf("64")?i=t.ver_lin64:-1!==r[0].toLowerCase().indexOf("darwin")&&-1!==r[2].toLowerCase().indexOf("64")&&(i=t.ver_osx64),o=e.split("-"),s=i.split("-"),d=0;d<o.length;d+=1){for(n=o[d].split("."),a=s[d].split("."),p=0;p<n.length;p+=1){if(parseInt(n[p],10)>parseInt(a[p],10)){l=0;break}if(parseInt(n[p],10)<parseInt(a[p],10)){l=1;break}}if(0!==l)break}return l},CCPConfigurationVerifierLib.prototype.isCCPInstalledAndSupported=function(i,o){var s,n=this;this.getServerVersion(function(e){var r=e.split(n.resultDelimiter);0===parseInt(r[0],10)?n.getArchType(function(e){var t,e=n.getModuleCore().convertResultToObject(e.substring(e.indexOf(n.resultDelimiter)+1));e.resultCode===n.getModuleCore().httpOK?((t=[]).push(e.kernelType),t.push(e.kernelVersion),t.push(e.buildArchitecture),s=0===n.compareVersions(r[1],i,t)?n.errorCodeOK:n.errorCodeNeedUpdate,o(s)):o(n.errorCodeNeedUpdate)}):o(r[0])})},CCPConfigurationVerifierLib.prototype.isModuleInstalledAndSupported=function(i,o){var s=this;this.getArchType(function(e){var r=s.getModuleCore().convertResultToObject(e.substring(e.indexOf(s.resultDelimiter)+1));r.resultCode===s.getModuleCore().httpOK?s.getModuleVersion(function(e){var e=e.split(s.resultDelimiter),t=0===parseInt(e[0],10)?((t=[]).push(r.kernelType),t.push(r.kernelVersion),t.push(r.buildArchitecture),0===s.compareVersions(e[1],i,t)?s.errorCodeOK:s.errorCodeNeedUpdate):e[0];o(t)}):o(r[0])})},CCPConfigurationVerifierLib.prototype.verifyCCPConfiguration=function(t,r,i,o,s){var n=this;this.isBrowserSupported(function(e){e===n.errorCodeOK?n.isCCPInstalledAndSupported(t,function(e){e===n.errorCodeOK?n.isModuleInstalledAndSupported(r,function(e){e===n.errorCodeOK?s(n.errorCodeOK):n.doUpdate(i,o,function(e){parseInt(e.split(n.resultDelimiter)[0],10)===n.errorCodeOK?n.isModuleInstalledAndSupported(r,function(e){e===n.errorCodeOK?s(n.errorCodeOK):s(n.errorCodeNeedRelogin)}):s(n.errorCodeUpdateFailed)})}):s(e)}):s(e)})},SignLibPekao.prototype=Object.create(CCPConfigurationVerifierLib.prototype),(SignLibPekao.prototype.constructor=SignLibPekao).prototype.getModuleCore=function(){return this.pekaoModuleCore},SignLibPekao.prototype.mapStatusCode=function(e,t){t={200:t.errorCodeOK,202:t.errorCodeOK,400:1,403:1,404:1,418:1,419:1,500:51,503:51,0:t.errorCodeOK,41:8,42:66,43:43,44:34,45:9,46:91,47:32774,48:1,49:33,50:48,51:51,55:130,56:56,57:4,58:6,59:7,60:64,61:131,31:-1,34:1,37:1}[e];return t=void 0===t?e:t},SignLibPekao.prototype.getModuleVersion=function(e){this.cover.coverPage();var e=this.getInnerCallback(e),t={cmd:"GetModuleVersion",params:{}};this.getModuleCore().prepareAndCallAjax(t,e)},SignLibPekao.prototype.changePin=function(e){this.cover.coverPage();var e=this.getInnerCallback(e),t={};this.isFullScreenSuported()?(t.cmd="ChangePin",t.params={},this.getModuleCore().prepareAndCallAjax(t,e)):e(ccp_getFullScreenNotSupportedError())},SignLibPekao.prototype.changePuk=function(e){this.cover.coverPage();var e=this.getInnerCallback(e),t={};this.isFullScreenSuported()?(t.cmd="ChangePuk",t.params={},this.getModuleCore().prepareAndCallAjax(t,e)):e(ccp_getFullScreenNotSupportedError())},SignLibPekao.prototype.generateKey=function(e,t){this.cover.coverPage();var t=this.getInnerCallback(t),r={};this.isFullScreenSuported()?(r.cmd="GenerateKey",r.params={},this.getModuleCore().isEmpty(e)?t(ccp_getNoDataError()):(e=e.replace(/\|/g,""),r.params.minLength=e,this.getModuleCore().prepareAndCallAjax(r,t))):t(ccp_getFullScreenNotSupportedError())},SignLibPekao.prototype.generateNewRequest=function(e,t){this.cover.coverPage();var t=this.getInnerCallback(t),r={};this.isFullScreenSuported()?(r.cmd="GenerateNewRequest",r.params={},this.getModuleCore().isEmpty(e)?t(ccp_getNoDataError()):(r.params.commonName=e,this.getModuleCore().prepareAndCallAjax(r,t))):t(ccp_getFullScreenNotSupportedError())},SignLibPekao.prototype.generateRequest=function(e){this.cover.coverPage();var e=this.getInnerCallback(e),t={cmd:"GenerateRequest",params:{}};this.getModuleCore().prepareAndCallAjax(t,e)},SignLibPekao.prototype.initializeCard=function(e){this.cover.coverPage();var e=this.getInnerCallback(e),t={};this.isFullScreenSuported()?(t.cmd="InitializeCard",t.params={},this.getModuleCore().prepareAndCallAjax(t,e)):e(ccp_getFullScreenNotSupportedError())},SignLibPekao.prototype.insertCertificate=function(e,t,r,i,o,s,n){this.cover.coverPage();var n=this.getInnerCallback(n),a={};this.getModuleCore().isEmpty(e)||this.getModuleCore().isEmpty(t)||this.getModuleCore().isEmpty(r)||this.getModuleCore().isEmpty(i)||this.getModuleCore().isEmpty(o)||this.getModuleCore().isEmpty(s)?n(ccp_getNoDataError()):(a.cmd="InsertCertificate",a.params={},a.params.newCertificate=e,a.params.oldKeyName=t,a.params.oldDigest=r,a.params.oldCertificate=i,a.params.newKeyName=o,a.params.newDigest=s,this.getModuleCore().prepareAndCallAjax(a,n))},SignLibPekao.prototype.insertNewCertificate=function(e,t,r){this.cover.coverPage();var r=this.getInnerCallback(r),i={};this.getModuleCore().isEmpty(e)||this.getModuleCore().isEmpty(t)?r(ccp_getNoDataError()):(i.cmd="InsertNewCertificate",i.params={},i.params.certificate=e,i.params.digest=t,this.getModuleCore().prepareAndCallAjax(i,r))},SignLibPekao.prototype.registerCert=function(e){this.cover.coverPage();var e=this.getInnerCallback(e),t={};this.isFullScreenSuported()?(t.cmd="RegisterCert",t.params={},this.getModuleCore().prepareAndCallAjax(t,e)):e(ccp_getFullScreenNotSupportedError())},SignLibPekao.prototype.setKey=function(e,t,r,i,o){var s,n;this.cover.coverPage(),o=this.getInnerCallback(o),s="key"+e,(n={}).keyId=e,n.keyName=t,n.keyValue=r,n.keyLocation=i,e=this.getModuleCore().objectToJsonString(n),this.getModuleCore().setSessionVar(s,e,o)},SignLibPekao.prototype.sign=function(e,t,r,i,o){this.cover.coverPage();var o=this.getInnerCallback(o),s={};this.isFullScreenSuported()?(s.cmd="Sign",s.params={},this.getModuleCore().isEmpty(e)||this.getModuleCore().isEmpty(r)?o(ccp_getNoDataError()):(s.params.keysId=e,s.params.defKeyId=t,s.params.data=r,s.params.useSMSCode=i,this.getModuleCore().prepareAndCallAjax(s,o))):o(ccp_getFullScreenNotSupportedError())},SignLibPekao.prototype.unblockCard=function(e){this.cover.coverPage();var e=this.getInnerCallback(e),t={};this.isFullScreenSuported()?(t.cmd="UnblockCard",t.params={},this.getModuleCore().prepareAndCallAjax(t,e)):e(ccp_getFullScreenNotSupportedError())},SignLibPekao.prototype.beginSession=function(e,t,i,o){var s=this.getModuleCore(),n=this;s.setSessionVar("ssn_id",e,function(r){s.setSessionVar("logging_type",t,function(t){s.setSessionVar("sms_code_no",i,function(e){parseInt((""+r).split(n.resultDelimiter)[0],10)===n.errorCodeOK?parseInt((""+t).split(n.resultDelimiter)[0],10)===n.errorCodeOK?o(e):o(t):o(r)})})})};var CCPPekaoInstance=new SignLibPekao;