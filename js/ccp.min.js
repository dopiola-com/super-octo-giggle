"use strict";function ccp_detectPrivateNetworkSupport(){return"https:"===location.protocol&&"localhost"!==location.hostname?{requiresPNA:!0,currentDomain:location.hostname,targetDomain:"localhost",chromeFlags:"--disable-features=BlockInsecurePrivateNetworkRequests"}:{requiresPNA:!1}}function ccp_analyzeConnectionError(e,t,r){var o,s=ccp_detectPrivateNetworkSupport();return console.log("CCP Debug - Error analysis:",{status:e.status,textStatus:t,errorThrown:r,readyState:e.readyState,requiresPNA:s.requiresPNA}),0===e.status&&"error"===t&&s.requiresPNA?(s=(""===(o=(r||"").toString().toLowerCase())||"error"===o)&&s.requiresPNA,console.log("CCP Debug - PNA Analysis:",{errorString:o,isProbablyPNABlock:s,reasoning:s?"Empty error + HTTPS domain = likely PNA block":"Non-empty error = likely connection issue"}),{isPNABlocked:s,isServerDown:!s,errorDetails:{status:e.status,textStatus:t,errorThrown:r,readyState:e.readyState}}):{isPNABlocked:!1,isServerDown:0===e.status,errorDetails:{status:e.status,textStatus:t,errorThrown:r,readyState:e.readyState}}}function ccp_analyzeConnectionErrorWithTiming(e,t,r,o){var s,i=ccp_detectPrivateNetworkSupport();return console.log("CCP Debug - Timing analysis:",{status:e.status,textStatus:t,errorThrown:r,duration:o+"ms",requiresPNA:i.requiresPNA}),0===e.status&&"error"===t&&i.requiresPNA?(s=o<150,(r||"").toString(),i=s&&i.requiresPNA,console.log("CCP Debug - Timing decision:",{duration:o,isVeryFast:s,isProbablyPNABlock:i,reasoning:i?"Fast error ("+o+"ms) from HTTPS = likely PNA block":"Slow error ("+o+"ms) = likely connection refused"}),{isPNABlocked:i,isServerDown:!i,errorDetails:{status:e.status,textStatus:t,errorThrown:r,duration:o}}):{isPNABlocked:!1,isServerDown:0===e.status,errorDetails:{status:e.status,textStatus:t,errorThrown:r,duration:o}}}function ccp_showPrivateNetworkInstructions(){console.log("TEST v1"),console.group("CCP Private Network Access Instructions"),console.log("Chrome blocks requests from HTTPS sites to localhost for security."),console.log("To enable access, you can:"),console.log("1. Start Chrome with: chrome.exe --disable-features=BlockInsecurePrivateNetworkRequests"),console.log("2. Or go to: chrome://flags/#block-insecure-private-network-requests"),console.log('3. Set "Block insecure private network requests" to "Disabled"'),console.log("4. Restart Chrome"),console.groupEnd()}jQuery.support.cors=!0;var ccp_configErrorStatus="jsConfigError";function ccp_getServerIsDownError(){var e={status:31,statusText:"SERVER_IS_DOWN",data:"server is most likely offline or unknown ajax error occured"};return e}function ccp_getNoDataError(){var e={status:34,statusText:"NO_DATA",data:"caller did not provide data"};return e}function ccp_getNoKeysSetError(){var e={status:35,statusText:"NO_KEYS_SET",data:"no keys set in session"};return e}function ccp_getJsBusyError(){var e={status:37,statusText:"JS_BUSY",data:"JavaScript library is processing another request"};return e}function ccp_getFullScreenNotSupportedError(){var e={status:38,statusText:"FULL_SCREEN_NOT_SUPPORTED",data:"Full screen is not supported on this system"};return e}function ccp_getPrivateNetworkBlockedError(){var e={status:32,statusText:"PRIVATE_NETWORK_BLOCKED",data:"Request blocked by Chrome Private Network Access policy - enable localhost access in Chrome flags"};return e}function CCPSignLibCore(){this.sessionIsOpening=!1,this.sessionId=null,this.userServerPort=null,this.getResultIsRunning=!1,this.askForAlive=!1,this.getUserServerPortSend=!1,this.keepAliveFailureCount=0,this.localJsStore=[],this.callbackList=[],this.version="2.3.0",this.sessionIdHeaderName="X-CCP-sessionId",this.cmdIdHeaderName="X-CCP-cmdId",this.dataType="text",this.serverAddress="https://localhost",this.dispatcherPort=8630,this.dllModule="",this.userServerPortStartValue=null,this.ajaxTimeout=1e4,this.getUserServerPortTimeout=5e3,this.callLoopInterval=1e3,this.requestMethod="POST",this.getResultTimeout=5e3,this.getResultInterval=1e3,this.keepAliveTimeout=5e3,this.keepAliveInterval=1e3,this.keepAliveMaxFailures=3,this.ajaxGetLogsTimeout=6e4,this.ajaxTestFunTimeout=2e4,this.httpOK=200,this.httpAccepted=202,this.httpBadRequest=400,this.httpForbidden=403,this.httpNotFound=404,this.httpNoSession=418,this.httpNoResult=419,this.httpInternalServerError=500,this.httpServiceUnavailableReason=503,this.lastError={},this.lastError.status=31,this.lastError.statusText="SERVER_IS_DOWN",this.lastError.data="server is most likely offline or unknown ajax error occured"}function ccp_quickConnectionTest(e){(new CCPSignLibCore).testConnectionStatus(e)}function ccp_advancedConnectionTest(s){if(!ccp_detectPrivateNetworkSupport().requiresPNA)return ccp_quickConnectionTest(s);console.log("CCP: Running advanced connection test with CORS detection...");var i=Date.now();$.ajax({url:"https://localhost:8630/GET_USER_SERVER_PORT",method:"POST",data:"",timeout:2e3,success:function(e,t,r){var o=Date.now()-i;s({status:"SUCCESS",code:r.status,message:"Serwer CCP działa prawidłowo",duration:o,method:"POST GET_USER_SERVER_PORT succeeded"})},error:function(e,t,r){var o=Date.now()-i,e={readyState:e.readyState,status:e.status,statusText:e.statusText,responseText:e.responseText,headers:e.getAllResponseHeaders?e.getAllResponseHeaders():"",textStatus:t,errorThrown:r,duration:o};console.log("CCP Advanced Test - Error details:",e);t={duration:o,details:e,method:"Advanced POST GET_USER_SERVER_PORT analysis"};0===e.readyState&&0===e.status&&!e.responseText&&!e.headers&&o<500?(t.status="BLOCKED",t.code="ERR_FAILED",t.message="Localhost zablokowany przez Chrome Private Network Access",t.solution="Uruchom Chrome z flagą: --disable-features=BlockInsecurePrivateNetworkRequests",t.confidence="HIGH - CORS blocking pattern detected"):(t.status="SERVICE_DOWN",t.code="ERR_CONNECTION_REFUSED",t.message="Usługa CCP nie działa",t.solution="Uruchom aplikację CCP",t.confidence="MEDIUM - Connection attempt failed"),s(t)}})}function CCPCover(){this.enabled=!0,this.coverDivId="CCP_CoverDiv",this.progressGif="../static/img/infoBox/preloader.gif",this.progressAlt="Trwa ładowanie",this.progressTitle="Trwa ładowanie",this.progressDescription="Proszę czekać",this.progressDescriptionColor="white"}function CCPSignLib(){this.cover=new CCPCover,this.resultDelimiter="|",this.errorCodeColumn=0,this.datailColumn=2,this.errorCodeOK=0,this.version="2.3.0";var e="Unknown OS",t=window.navigator.appVersion;-1!==t.indexOf("Win")&&(e="Windows"),-1!==t.indexOf("Mac")&&(e="MacOS"),-1!==t.indexOf("X11")&&(e="UNIX"),-1!==t.indexOf("Linux")&&(e="Linux"),this.OSName=e}function CCPUpdaterModuleSystem(){this.core=new CCPSignLibCore,this.core.dllModule="updater",this.errorCodeConnectionError=45,this.errorCodeProxySet=46,this.core.setUserServerPortStartValue(this.core.dispatcherPort)}function CCPUpdaterModuleUser(){this.core=new CCPSignLibCore,this.core.dllModule="updater",this.errorCodeConnectionError=45,this.errorCodeProxySet=46}function CCPUpdaterLib(){CCPSignLib.call(this),this.updaterModule=new CCPUpdaterModuleSystem,this.updaterModuleCore=this.updaterModule.core,this.updaterModuleUser=new CCPUpdaterModuleUser,this.updaterModuleUserCore=this.updaterModuleUser.core}function CCPConfigurationVerifierLib(){CCPUpdaterLib.call(this)}function CCPPekaoModule(){this.core=new CCPSignLibCore,this.core.dllModule="pekao"}function SignLibPekao(){CCPConfigurationVerifierLib.call(this),this.pekaoModule=new CCPPekaoModule,this.pekaoModuleCore=this.pekaoModule.core}CCPSignLibCore.prototype.getLastError=function(){var e={};return e.status=this.lastError.status,e.statusText=this.lastError.statusText,e.data=this.lastError.data,e},CCPSignLibCore.prototype.objectToJsonString=function(e){if("undefined"!=typeof JSON&&void 0!==JSON.stringify)return JSON.stringify(e);var t,r,o,s=typeof e,i=[];if("object"!==s||null===e)return"string"===s&&(e='"'+e.replace(/\"/g,'\\"')+'"'),String(e);for(t in o=e&&e.constructor===Array,e)e.hasOwnProperty(t)&&("string"===(s=typeof(r=e[t]))?r='"'+r.replace(/\"/g,'\\"')+'"':"object"===s&&null!==r&&(r=this.objectToJsonString(r)),i.push((o?"":'"'+t+'":')+String(r)));return(o?"[":"{")+String(i)+(o?"]":"}")},CCPSignLibCore.prototype.jsonStringToObject=function(e){return $.parseJSON(e)},CCPSignLibCore.prototype.isEmpty=function(e){return null==e||e.length<=0},CCPSignLibCore.prototype.notDefined=function(e){return null==e},CCPSignLibCore.prototype.convertResultToJson=function(t){var r,o,t=this.notDefined(t.data)?(o=t,-1):(o=t.data,t.status);if("object"==typeof o)return this.objectToJsonString(o);if("string"!=typeof o)return o===parseInt(o,10)?(r={}).resultCode=o:((r={}).resultCode=t,r.messageShort=o),this.objectToJsonString(r);try{return r=this.jsonStringToObject(o),o}catch(e){return r={},o=o.split("|"),isNaN(o[0])||this.isEmpty(o[0])?(r.resultCode=t,r.messageShort=o[0],1<o.length&&(r.messageLong=o[1])):(r.resultCode=parseInt(o[0],10),1<o.length&&(r.messageShort=o[1]),2<o.length&&(r.messageLong=o[2])),this.objectToJsonString(r)}},CCPSignLibCore.prototype.convertResultToObject=function(t){var r;if("object"==typeof t)return t;if("string"!=typeof t)return t===parseInt(t,10)?(r={}).resultCode=t:(r={resultCode:-1}).messageShort=t,r;try{return r=this.jsonStringToObject(t)}catch(e){return r={},t=t.split("|"),isNaN(t[0])?(r.resultCode=-1,r.messageShort=t[0],1<t.length&&(r.messageLong=t[1])):(r.resultCode=parseInt(t[0],10),1<t.length&&(r.messageShort=t[1]),2<t.length&&(r.messageLong=t[2])),r}},CCPSignLibCore.prototype.convertResultToPipe=function(t){var e,r="";if("object"==typeof t)return r+=t.resultCode,this.isEmpty(t.messageShort)||(r+="|"+t.messageShort),this.isEmpty(t.messageLong)||(r+="|"+t.messageLong),r;if("string"!=typeof t)return t.toString();try{return r+=(e=this.jsonStringToObject(t)).resultCode,this.isEmpty(e.messageShort)||(r+="|"+e.messageShort),this.isEmpty(e.messageLong)||(r+="|"+e.messageLong),r}catch(e){return t}},CCPSignLibCore.prototype.createServerUrl=function(e,t,r,o){return null===t&&(t=0),this.isEmpty(r)?e+":"+t+"/"+o:e+":"+t+"/"+r+"/"+o},CCPSignLibCore.prototype.isSessionOpen=function(){return!this.isEmpty(this.sessionId)},CCPSignLibCore.prototype.isSessionStillOpenning=function(){return!!this.sessionIsOpening},CCPSignLibCore.prototype.processServerIsDown=function(){this.askForAlive=!1,this.sessionId=null,this.userServerPort=this.userServerPortStartValue,this.keepAliveFailureCount=0,this.sessionIsOpening=!1},CCPSignLibCore.prototype.setUserServerPortStartValue=function(e){this.userServerPortStartValue=e,this.userServerPort=e},CCPSignLibCore.prototype.prepareAndCallAjax=function(e,t,r){var o={};o.restParams=e,o.callBackFunction=t,o.cancelled=!1,this.prepareAndCallAjaxInner(o,r)},CCPSignLibCore.prototype.prepareAndCallAjaxInner=function(e,t,r){!this.setServerConnectionAndSession(e,t)||null!==(r=void 0!==r?r:this.prepareAjaxRequest(e,t))&&this.callAjaxRequest(r,e)},CCPSignLibCore.prototype.setServerConnectionAndSession=function(e,t){return!0!==e.cancelled&&(null!==this.userServerPort&&null!==this.sessionId||(this.isSessionStillOpenning()||(null===this.userServerPort?this.getUserServerPort(e):this.openSession(this.userServerPort,e)),r=this,o=e,s=t,setTimeout(function(){r.prepareAndCallAjaxInner(o,s)},this.callLoopInterval),!1));var r,o,s},CCPSignLibCore.prototype.prepareAjaxRequest=function(e,t){var r,o,s,i,n,a,c,l,u,d=e.restParams,p=e.callBackFunction,h={},C=(new Date).getTime();if(void 0===t&&(t=this.ajaxTimeout),h.cmdId=C,this.isSessionOpen())r=this,o=C,h.beforeSend=function(e){e.setRequestHeader(r.sessionIdHeaderName,r.sessionId),e.setRequestHeader(r.cmdIdHeaderName,o)};else if(this.isSessionStillOpenning())return p(ccp_getJsBusyError()),null;return h.type=this.requestMethod,h.timeout=t,h.cache=!1,h.dataType=this.dataType,this.isEmpty(d.params)?h.data="":h.data=d.params,h.cmd=d.cmd,s=this,n=p,(i=h).success=function(e,t,r){s.onAjaxSuccess(e,t,r,i,n)},a=this,l=p,u=e,(c=h).error=function(e,t,r){a.onAjaxError(e,t,r,c,l,u)},h},CCPSignLibCore.prototype.onAjaxSuccess=function(e,t,r,o,s){var i;r.status===this.httpOK?((i={}).status=r.status,i.statusText=r.statusText,i.data=e,s(i)):r.status===this.httpAccepted&&(o.sessionId=this.sessionId,this.setCallback(o,s))},CCPSignLibCore.prototype.onAjaxError=function(e,t,r,o,s,i){var n;switch(e.status){case this.httpBadRequest:case this.httpForbidden:case this.httpNotFound:case this.httpInternalServerError:this.processServerIsDown(),(n={}).status=e.status,n.statusText=e.statusText,n.data=e.responseText,s(n);break;case this.httpServiceUnavailableReason:(n={}).status=e.status,n.statusText=e.statusText,n.data=e.responseText,s(n);break;case this.httpNoSession:this.processServerIsDown(),this.prepareAndCallAjaxInner(i,o.timeout,o);break;default:this.processServerIsDown(),s(this.getLastError())}},CCPSignLibCore.prototype.callAjaxRequest=function(e,t){t=t.callBackFunction;if(this.isSessionStillOpenning())t(ccp_getJsBusyError());else{if(this.userServerPort<=0)return this.userServerPort=null,void t(ccp_getServerIsDownError());e.url=this.createServerUrl(this.serverAddress,this.userServerPort,this.dllModule,e.cmd),jQuery.ajax(e)}},CCPSignLibCore.prototype.getUserServerPort=function(e){var t,r,s,i,o,n;!1===this.getUserServerPortSend&&(this.getUserServerPortSend=!0,r=Date.now(),(t={}).url=this.createServerUrl(this.serverAddress,this.dispatcherPort,"","GET_USER_SERVER_PORT"),t.type=this.requestMethod,t.timeout=this.getUserServerPortTimeout,t.cache=!1,t.dataType=this.dataType,t.data="",t._startTime=r,o=this,n=e,t.success=function(e,t,r){o.onUserServerPortSuccess(e,t,r,n)},s=this,i=r,t.error=function(e,t,r){var o=Date.now()-i;s.onUserServerPortError(e,t,r,o)},jQuery.ajax(t))},CCPSignLibCore.prototype.onUserServerPortSuccess=function(e,t,r,o){r.status!==this.httpOK||this.isEmpty(e)?(this.userServerPort=0,this.sessionId=0,this.sessionIsOpening=!1):this.userServerPort=e,this.getUserServerPortSend=!1},CCPSignLibCore.prototype.onUserServerPortError=function(e,t,r,o){void 0===o&&(o=0),console.error("CCP Server error:",{status:e.status,textStatus:t,errorThrown:r,duration:o+"ms"});t=ccp_analyzeConnectionErrorWithTiming(e,t,r,o);t.isPNABlocked?(console.error("CCP: Connection blocked - Private Network Access policy detected"),ccp_showPrivateNetworkInstructions(),this.lastError.status=32,this.lastError.statusText="PRIVATE_NETWORK_BLOCKED",this.lastError.data="Request blocked by Chrome Private Network Access policy"):t.isServerDown?(console.log("CCP: Server appears to be down or unreachable"),this.lastError=ccp_getServerIsDownError()):0!==e.status?(this.lastError.status=e.status,this.lastError.statusText=e.statusText,this.lastError.data=e.responseText):this.lastError=ccp_getServerIsDownError(),this.userServerPort=0,this.sessionId=0,this.sessionIsOpening=!1,this.getUserServerPortSend=!1},CCPSignLibCore.prototype.openSession=function(e,t){this.sessionIsOpening=!0;var o,s,i,n,a,r={};r.url=this.createServerUrl(this.serverAddress,e,"","OPEN_SESSION"),r.type=this.requestMethod,r.timeout=this.ajaxTimeout,r.cache=!1,r.dataType=this.dataType,r.data={},r.data.sessionVars=this.localJsStoreToString(),o=this,s=e,i=t,r.success=function(e,t,r){o.onOpenSessionSuccess(e,t,r,s,i)},n=this,a=t,r.error=function(e,t,r){n.onOpenSessionError(e,t,r,a)},jQuery.ajax(r)},CCPSignLibCore.prototype.onOpenSessionSuccess=function(e,t,r,o,s){var i;r.status!==this.httpOK||this.isEmpty(e)?(this.processServerIsDown(),i={},0!==r.status?(i.status=r.status,i.statusText=r.statusText,i.data=e):i=this.getLastError(),s.callBackFunction(i),s.cancelled=!0):(r=e,this.isSessionOpen()||this.isEmpty(r)||(this.sessionId=r,this.startKeepAlive(),!1===this.getResultIsRunning&&this.startGetResult()),this.userServerPort=o),this.sessionIsOpening=!1},CCPSignLibCore.prototype.onOpenSessionError=function(e,t,r,o){this.processServerIsDown();var s={};0!==e.status?(s.status=e.status,s.statusText=e.statusText,s.data=e.responseText):s=this.getLastError(),o.callBackFunction(s),o.cancelled=!0},CCPSignLibCore.prototype.startGetResult=function(){var e;this.getResultIsRunning=!0,e=this,setTimeout(function(){e.getResults()},this.getResultInterval)},CCPSignLibCore.prototype.getResults=function(){var e,t,r,o,s,i=function(t,r,o){return function(e){e.setRequestHeader(t.sessionIdHeaderName,r),e.setRequestHeader(t.cmdIdHeaderName,o)}},n=function(o,s){return function(e,t,r){o.onGetResultSuccess(e,t,r,s)}},a=function(o,s){return function(e,t,r){o.onGetResultError(e,t,r,s)}};if(null!==this.userServerPort)for(s=0;s<this.callbackList.length;s+=1)t=(e=this.callbackList[s].ajaxRequest).cmdId,r=this.sessionId,o={},this.isEmpty(e.sessionId)||(r=e.sessionId),o.url=this.createServerUrl(this.serverAddress,this.userServerPort,this.dllModule,"GET_RESULT"),o.type=this.requestMethod,o.timeout=this.getResultTimeout,o.cache=!1,o.dataType=this.dataType,o.data="",o.beforeSend=i(this,r,t),o.success=n(this,t),o.error=a(this,t),jQuery.ajax(o);this.startGetResult()},CCPSignLibCore.prototype.onGetResultSuccess=function(e,t,r,o){var s;r.status===this.httpOK&&((s={}).status=r.status,s.statusText=r.statusText,s.data=e,this.callbackFunction(o,s))},CCPSignLibCore.prototype.onGetResultError=function(e,t,r,o){var s;e.status!==this.httpNoSession&&e.status!==this.httpForbidden||this.processServerIsDown(),0!==e.status?((s={}).status=e.status,s.statusText=e.statusText,s.data=e.responseText,this.callbackFunction(o,s)):(this.processServerIsDown(),e=this.getLastError(),this.callbackFunction(o,e))},CCPSignLibCore.prototype.startKeepAlive=function(){var e;this.askForAlive=!0,e=this,setTimeout(function(){e.keepAlive()},this.keepAliveInterval)},CCPSignLibCore.prototype.keepAlive=function(){var t,o,s,e={};this.isSessionOpen()&&!1!==this.askForAlive&&(e.url=this.createServerUrl(this.serverAddress,this.userServerPort,this.dllModule,"ALIVE"),e.type=this.requestMethod,e.timeout=this.keepAliveTimeout,e.cache=!1,e.dataType=this.dataType,e.data={},t=this,e.beforeSend=function(e){e.setRequestHeader(t.sessionIdHeaderName,t.sessionId)},o=this,e.success=function(e,t,r){o.onKeepAliveSuccess(e,t,r)},s=this,e.error=function(e,t,r){s.onKeepAliveError(e,t,r)},jQuery.ajax(e),this.startKeepAlive())},CCPSignLibCore.prototype.onKeepAliveSuccess=function(e,t,r){r.status===this.httpOK&&(this.keepAliveFailureCount=0)},CCPSignLibCore.prototype.onKeepAliveError=function(e,t,r){e.status===this.httpNoSession?this.processServerIsDown():(this.keepAliveFailureCount+=1,this.keepAliveFailureCount>=this.keepAliveMaxFailures&&(this.askForAlive=!1),!1===this.askForAlive&&this.processServerIsDown())},CCPSignLibCore.prototype.isLocalKeySet=function(e){for(var t=0;t<this.localJsStore.length;t+=1)if(this.localJsStore[t].key===e)return t;return-1},CCPSignLibCore.prototype.saveInLocalJsStore=function(e,t){var r=this.isLocalKeySet(e),o={};o.key=e,o.value=t,r<0&&(r=this.localJsStore.push(o)-1),this.localJsStore[r]=o},CCPSignLibCore.prototype.localJsStoreToString=function(){return this.objectToJsonString(this.localJsStore)},CCPSignLibCore.prototype.setCallback=function(e,t){var r=e.cmdId,o={};return-1===this.isCallbackSet(r)&&(o.ajaxRequest=e,o.callback=t,this.callbackList.push(o),!0)},CCPSignLibCore.prototype.isCallbackSet=function(e){for(var t=0;t<this.callbackList.length;t+=1)if(this.callbackList[t].ajaxRequest.cmdId===e)return t;return-1},CCPSignLibCore.prototype.getCallback=function(e){e=this.isCallbackSet(e);if(-1!==e)return this.callbackList[e].callback},CCPSignLibCore.prototype.removeCallback=function(e){e=this.isCallbackSet(e);-1!==e&&this.callbackList.splice(e,1)},CCPSignLibCore.prototype.callbackFunction=function(e,t){var r=this.getCallback(e);this.isEmpty(r)||(this.removeCallback(e),r(t))},CCPSignLibCore.prototype.setSessionVar=function(e,t,r){var o={cmd:"SET_SESSION_VAR",params:{}};o.params.key=e,o.params.value=t,this.prepareAndCallAjax(o,r),this.saveInLocalJsStore(e,t)},CCPSignLibCore.prototype.checkPrivateNetworkAccess=function(){var e=ccp_detectPrivateNetworkSupport();return e.requiresPNA?(console.log("CCP: Private Network Access check result:"),console.log("- Current domain:",e.currentDomain),console.log("- Target domain:",e.targetDomain),console.log("- Chrome flags needed:",e.chromeFlags),console.log("- Status: May require Chrome flags to access localhost")):console.log("CCP: Private Network Access not required (running on localhost or HTTP)"),e},CCPSignLibCore.prototype.testConnectionStatus=function(i){var n=Date.now(),e={};console.log("CCP: Testing connection to localhost:8630/GET_USER_SERVER_PORT..."),e.url=this.serverAddress+":8630/GET_USER_SERVER_PORT",e.type="POST",e.timeout=3e3,e.cache=!1,e.dataType=this.dataType,e.data="",e.success=function(e,t,r){var o=Date.now()-n,o={status:"SUCCESS",code:r.status,message:"Serwer CCP działa prawidłowo",duration:o,details:{httpStatus:r.status,response:e}};console.log("CCP: Connection test SUCCESS",o),i(o)},e.error=function(e,t,r){var o=Date.now()-n,s=ccp_detectPrivateNetworkSupport(),o=(console.log("CCP: Connection test FAILED:",{status:e.status,textStatus:t,errorThrown:r,duration:o+"ms"}),{duration:o,details:{httpStatus:e.status,textStatus:t,errorThrown:r,requiresPNA:s.requiresPNA}});0===e.status&&s.requiresPNA?(console.log("CCP Debug - Detailed error analysis:",{readyState:e.readyState,responseText:e.responseText,statusText:e.statusText,getAllResponseHeaders:e.getAllResponseHeaders?e.getAllResponseHeaders():"N/A",textStatus:t,errorThrown:r}),s={hasEmptyResponse:!e.responseText,hasEmptyHeaders:!e.getAllResponseHeaders||""===e.getAllResponseHeaders(),readyStateUnsent:0===e.readyState,readyStateOpened:1===e.readyState,textStatusError:"error"===t,emptyErrorThrown:!r||""===r},console.log("CCP Debug - Error indicators:",s),s.readyStateUnsent&&s.hasEmptyResponse&&s.hasEmptyHeaders&&s.emptyErrorThrown?(o.status="BLOCKED",o.code="ERR_FAILED",o.message="Localhost zablokowany przez Chrome Private Network Access",o.solution="Uruchom Chrome z flagą: --disable-features=BlockInsecurePrivateNetworkRequests",o.reasoning="readyState=0, empty headers/response, empty error - likely CORS/PNA block"):(o.status="SERVICE_DOWN",o.code="ERR_CONNECTION_REFUSED",o.message="Usługa CCP nie działa",o.solution="Uruchom aplikację CCP",o.reasoning="Connection attempt made but failed - likely service down"),o.indicators=s):0===e.status?(o.status="SERVICE_DOWN",o.code="ERR_CONNECTION_REFUSED",o.message="Usługa CCP nie działa",o.solution="Uruchom aplikację CCP"):(o.status="OTHER_ERROR",o.code=e.status,o.message="Inny błąd: "+e.status+" "+e.statusText,o.solution="Sprawdź konfigurację serwera"),console.log("CCP: Connection diagnosis:",o),i(o)},jQuery.ajax(e)},Object.create||(Object.create=function(e,t){if("object"!=typeof e&&"function"!=typeof e)throw new TypeError("Object prototype may only be an Object: "+e);if(null===e)throw new Error("This browser's implementation of Object.create is a shim and doesn't support 'null' as the first argument.");if(void 0!==t)throw new Error("This browser's implementation of Object.create is a shim and doesn't support a second argument.");function r(){}return r.prototype=e,new r}),CCPCover.prototype.getFrameDocument=function(){for(var e,t,r=window.parent.frames,o=0;o<r.length;o+=1)"main"===r[o].name&&(t=r[o]);return e=(t=0<r.length?r[0]:t)?t.document:e},CCPCover.prototype.getCoverDiv=function(e){var t;return t=e?e.getElementById(this.coverDivId):t},CCPCover.prototype.coverPage=function(){var e,t,r;this.enabled&&(e=this.getFrameDocument(),t=this.getCoverDiv(e),r=null,e&&(r=e.getElementsByTagName("BODY")),t?t.style.display="block":r&&0!==r.length&&this.createCoverDiv(e),this.relocateCoverDiv())},CCPCover.prototype.createProgressIndicator=function(e,t){var r=e.createElement("div");t.appendChild(r),r.style.zIndex="2100",r.style.position="absolute",r.style.top="50%",r.style.left="50%",r.style.textAlign="center",t=e.createElement("img"),r.appendChild(t),t.src=this.progressGif,t.alt=this.progressAlt,t.title=this.progressTitle,t=e.createElement("br"),r.appendChild(t),t=e.createElement("p"),r.appendChild(t),t.innerHTML=this.progressDescription,t.style.color=this.progressDescriptionColor},CCPCover.prototype.createCoverDiv=function(e){var t,r=e.createElement("div");e.body.appendChild(r),this.createProgressIndicator(e,r),r.id=this.coverDivId,r.style.display="block",r.style.position="fixed",r.style.top="0",r.style.left="0",r.style.width="100%",r.style.height="100%",r.style.backgroundColor="white",r.style.MozOpacity="0.8",r.style.opacity=".80",r.style.filter="alpha(opacity=80)",r.style.zIndex="2099",t=this,e=function(){t.relocateCoverDiv()},$(window).scroll(e)},CCPCover.prototype.relocateCoverDiv=function(){var e,t,r=this.getFrameDocument(),r=this.getCoverDiv(r);r&&(e=window.pageYOffset,t=window.pageXOffset,r.top=e,r.left=t)},CCPCover.prototype.uncoverPage=function(){var e;this.enabled&&(e=this.getFrameDocument(),(e=this.getCoverDiv(e))&&(e.style.display="none"))},CCPSignLib.prototype.getModuleCore=function(){},CCPSignLib.prototype.getInnerCallback=function(t){return r=this,function(e){e=r.convertResult(e,r.mapStatusCode);r.getModuleCore().callbackList.length<=0&&r.updaterModuleCore.callbackList.length<=0&&r.updaterModuleUserCore.callbackList.length<=0&&r.cover.uncoverPage(),t(e)};var r},CCPSignLib.prototype.mapStatusCode=function(e,t){return e},CCPSignLib.prototype.isFullScreenSuported=function(){return"MacOS"!==this.OSName||window.outerHeight!==window.screen.height||window.outerWidth!==window.screen.width},CCPSignLib.prototype.convertResult=function(e,t){var r,o,s,i=!0;return e.status===this.getModuleCore().httpOK&&1<e.data.split(this.resultDelimiter).length&&(i=!1),s=e.data,i?(o=t(e.status,this),i=e.statusText,r=o.toString(),e.status!==this.getModuleCore().httpOK&&i&&(r=r+this.resultDelimiter+i),s&&(r=r+this.resultDelimiter+s)):(o=t(this.getErrorCodeFromTextResult(s),this),e=s.indexOf(this.resultDelimiter),r=o.toString()+s.substr(e)),r},CCPSignLib.prototype.getErrorCodeFromTextResult=function(e){e=e.split(this.resultDelimiter)[this.errorCodeColumn];return parseInt(e,10)},CCPSignLib.prototype.getDetailFromTextResult=function(e){return e.split(this.resultDelimiter)[this.datailColumn]},CCPSignLib.prototype.getArchType=function(e){var t;this.cover.coverPage(),e=this.getInnerCallback(e),t={cmd:"ARCH_TYPE",params:{}},this.getModuleCore().prepareAndCallAjax(t,e)},CCPSignLib.prototype.setLanguage=function(e,t){this.cover.coverPage(),t=this.getInnerCallback(t),this.getModuleCore().setSessionVar("languageId",e,t)},CCPSignLib.prototype.getServerVersion=function(e){this.cover.coverPage();var e=this.getInnerCallback(e),t={cmd:"SERVER_VERSION",params:{}};this.getModuleCore().prepareAndCallAjax(t,e)},CCPSignLib.prototype.closeSession=function(e){this.cover.coverPage();var e=this.getInnerCallback(e),t={cmd:"CLOSE_SESSION",params:{}};this.getModuleCore().prepareAndCallAjax(t,e)},CCPUpdaterLib.prototype=Object.create(CCPSignLib.prototype),(CCPUpdaterLib.prototype.constructor=CCPUpdaterLib).prototype.getInnerCallbackUpdater=function(t){return r=this,function(e){e=r.convertResult(e,r.mapUpdaterStatusCode);r.getModuleCore().callbackList.length<=0&&r.updaterModuleCore.callbackList.length<=0&&r.updaterModuleUserCore.callbackList.length<=0&&r.cover.uncoverPage(),t(e)};var r},CCPUpdaterLib.prototype.mapUpdaterStatusCode=function(e,t){t={200:t.errorCodeOK,202:t.errorCodeOK,400:1,403:1,404:1,418:1,419:1,500:51,503:51,0:t.errorCodeOK,41:41,42:42,43:43,44:44,45:45,46:46,47:47,31:-1,34:1,37:1}[e];return t=void 0===t?e:t},CCPUpdaterLib.prototype.closeUpdaterSystemSession=function(e){this.cover.coverPage();var e=this.getInnerCallbackUpdater(e),t={cmd:"CLOSE_SESSION",params:{}};this.updaterModuleCore.prepareAndCallAjax(t,e)},CCPUpdaterLib.prototype.startUpdate=function(e,t,r,o){this.cover.coverPage();var s=this,i=this.getInnerCallbackUpdater(function(t){s.closeUpdaterSystemSession(function(e){o(t)})}),n={cmd:"Update",params:{}};this.getModuleCore().isEmpty(e)||this.getModuleCore().isEmpty(t)?i(ccp_getNoDataError()):("string"==typeof e?n.params.url=e:n.params=e,n.params.destFileName=t,n.params.proxySettings=r,this.updaterModuleCore.prepareAndCallAjax(n,i))},CCPUpdaterLib.prototype.showConnectionWarning=function(e,t){this.cover.coverPage();var t=this.getInnerCallbackUpdater(t),r={cmd:"ShowConnectionWarning",params:{}};""===e?t(ccp_getNoDataError()):(r.params.connectionErrorCode=e,this.updaterModuleUserCore.prepareAndCallAjax(r,t))},CCPUpdaterLib.prototype.doUpdate=function(t,r,e){var o,n,a,c,l,u,d,s=this;c=this,l=t,u=r,d=e,o=function(e){var t,r,o,s,i;c.getErrorCodeFromTextResult(e)===c.updaterModule.errorCodeConnectionError?(o=l,s=u,i=d,t=function(e){r.getErrorCodeFromTextResult(e)!==r.updaterModuleUser.errorCodeProxySet?i(e):(n=r.getDetailFromTextResult(e),r.startUpdate(o,s,n,i))},a=(r=c).getDetailFromTextResult(e),c.showConnectionWarning(a,t)):d(e)},s.closeSession(function(e){s.startUpdate(t,r,"",o)})},CCPConfigurationVerifierLib.prototype=Object.create(CCPUpdaterLib.prototype),(CCPConfigurationVerifierLib.prototype.constructor=CCPConfigurationVerifierLib).prototype.errorCodeNotInstalled=-1,CCPConfigurationVerifierLib.prototype.errorCodeUnsupportedBrowser=21,CCPConfigurationVerifierLib.prototype.errorCodeNeedUpdate=22,CCPConfigurationVerifierLib.prototype.errorCodeUpdateFailed=23,CCPConfigurationVerifierLib.prototype.errorCodeNeedRelogin=24,CCPConfigurationVerifierLib.prototype.isBrowserSupported=function(e){var t=navigator.userAgent.toLowerCase(),r=parseInt(navigator.appVersion,10),o=(parseFloat(navigator.appVersion),-1!==t.indexOf("mozilla")&&-1===t.indexOf("spoofer")&&-1===t.indexOf("compatible")&&-1===t.indexOf("opera")&&-1===t.indexOf("webtv")&&-1===t.indexOf("hotjava")),o=(!o||-1===t.indexOf(";nav")&&t.indexOf("; nav"),t.indexOf("gecko"),(-1!==t.indexOf("msie")||-1!==t.indexOf("trident"))&&-1===t.indexOf("opera")),s=o&&r<4,i=o&&4===r&&-1!==t.indexOf("msie 4"),n=o&&4===r&&-1!==t.indexOf("msie 5.0"),a=o&&4===r&&-1!==t.indexOf("msie 5.5"),c=(o&&4===r&&t.indexOf("msie 6."),o&&-1!==t.indexOf("msie 7.")),o=(o&&t.indexOf("msie 8."),!(!o||s||i||n||a||c)),s=(t.indexOf("aol"),t.indexOf("aol 5"),t.indexOf("aol 6"),-1!==t.indexOf("opera/")||-1!==t.indexOf("opr/")),i=s&&-1!==t.indexOf("version/2.")||-1!==t.indexOf("opr/2.")||-1!==t.indexOf("opera 2."),n=s&&-1!==t.indexOf("version/3.")||-1!==t.indexOf("opr/3.")||-1!==t.indexOf("opera 3."),a=s&&-1!==t.indexOf("version/4.")||-1!==t.indexOf("opr/4.")||-1!==t.indexOf("opera 4."),c=(s&&-1!==t.indexOf("version/5.")||-1!==t.indexOf("opr/5.")||t.indexOf("opera 5."),s&&!i&&!n&&!a),i=s&&-1!==t.indexOf("version/6.")||-1!==t.indexOf("opr/6.")||-1!==t.indexOf("opera 6."),n=s&&-1!==t.indexOf("version/7.")||-1!==t.indexOf("opr/7.")||-1!==t.indexOf("opera 7."),a=s&&-1!==t.indexOf("version/8.")||-1!==t.indexOf("opr/8.")||-1!==t.indexOf("opera 8."),l=s&&-1!==t.indexOf("version/9.")||-1!==t.indexOf("opr/9.")||-1!==t.indexOf("opera 9."),c=(s&&-1!==t.indexOf("version/10.")||-1!==t.indexOf("opr/10.")||t.indexOf("opera 10."),c&&!i&&!n&&!a&&!l),i=s&&-1!==t.indexOf("version/11.")||-1!==t.indexOf("opr/11.")||-1!==t.indexOf("opera 11."),n=s&&-1!==t.indexOf("version/12.")||-1!==t.indexOf("opr/12."),a=s&&-1!==t.indexOf("version/13.")||-1!==t.indexOf("opr/13."),l=s&&-1!==t.indexOf("version/14.")||-1!==t.indexOf("opr/14."),s=(s&&-1!==t.indexOf("version/15.")||t.indexOf("opr/15."),c&&!i&&!n&&!a&&!l),c=-1!==t.indexOf("edge"),i=-1!==t.indexOf("chrome")&&-1===t.indexOf("opr/")&&-1===t.indexOf("edge"),n=-1!==t.indexOf("chrome 0.")||-1!==t.indexOf("chrome/0."),a=-1!==t.indexOf("chrome 1.")||-1!==t.indexOf("chrome/1."),l=-1!==t.indexOf("chrome 2.")||-1!==t.indexOf("chrome/2."),u=-1!==t.indexOf("chrome 3.")||-1!==t.indexOf("chrome/3."),d=-1!==t.indexOf("chrome 4.")||-1!==t.indexOf("chrome/4."),p=-1!==t.indexOf("chrome 5.")||-1!==t.indexOf("chrome/5."),h=-1!==t.indexOf("chrome 6.")||-1!==t.indexOf("chrome/6."),C=-1!==t.indexOf("chrome 7.")||-1!==t.indexOf("chrome/7."),f=-1!==t.indexOf("chrome 8.")||-1!==t.indexOf("chrome/8."),g=-1!==t.indexOf("chrome 9.")||-1!==t.indexOf("chrome/9."),S=-1!==t.indexOf("chrome 10.")||-1!==t.indexOf("chrome/10."),v=-1!==t.indexOf("chrome 11.")||-1!==t.indexOf("chrome/11."),x=-1!==t.indexOf("chrome 12.")||-1!==t.indexOf("chrome/12."),m=-1!==t.indexOf("chrome 13.")||-1!==t.indexOf("chrome/13."),O=-1!==t.indexOf("chrome 14.")||-1!==t.indexOf("chrome/14."),P=-1!==t.indexOf("chrome 15.")||-1!==t.indexOf("chrome/15."),y=-1!==t.indexOf("chrome 16.")||-1!==t.indexOf("chrome/16."),b=-1!==t.indexOf("chrome 17.")||-1!==t.indexOf("chrome/17."),k=-1!==t.indexOf("chrome 18.")||-1!==t.indexOf("chrome/18."),i=!(!!(!i||n||a||l||u||d||p||h||C||f||g)||S||v||x||m||O||P||y||b||k),n=-1!==t.indexOf("safari")&&-1===t.indexOf("chrome"),a=(n&&t.indexOf("version"),n&&-1!==t.indexOf("version/3")),l=n&&-1!==t.indexOf("version/4"),u=n&&-1!==t.indexOf("version/5"),d=n&&-1!==t.indexOf("version")&&!a&&!l&&!u,p=(/^((?!chrome).)*safari/i.test(t),t.indexOf("webtv"),-1===t.indexOf("navio")&&t.indexOf("navio_aoltv"),t.indexOf("hotjava"),-1!==t.indexOf("firefox")),h=(-1===t.indexOf("firefox 3.6")&&t.indexOf("firefox/3.6"),-1!==t.indexOf("firefox 1.")||-1!==t.indexOf("firefox/1.")||-1!==t.indexOf("firefox 2.")||-1!==t.indexOf("firefox/2.")||-1!==t.indexOf("firefox 3.0")||-1!==t.indexOf("firefox/3.0")||-1!==t.indexOf("firefox 3.1")||-1!==t.indexOf("firefox/3.1")||-1!==t.indexOf("firefox 3.2")||-1!==t.indexOf("firefox/3.2")||-1!==t.indexOf("firefox 3.3")||-1!==t.indexOf("firefox/3.3")||-1!==t.indexOf("firefox 3.4")||-1!==t.indexOf("firefox/3.4")),C=(h||-1!==t.indexOf("firefox 3.5")||t.indexOf("firefox/3.5"),p&&!h),f=(-1===t.indexOf("win")&&t.indexOf("16bit"),-1!==t.indexOf("win95")||-1!==t.indexOf("windows 95")),g=(-1===t.indexOf("win16")&&-1===t.indexOf("16bit")&&-1===t.indexOf("windows 3.1")&&t.indexOf("windows 16-bit"),-1===t.indexOf("windows 3.1")&&-1===t.indexOf("win16")&&t.indexOf("windows 16-bit"),t.indexOf("win 9x 4.90"),t.indexOf("windows nt 5.0"),-1!==t.indexOf("win98")||-1!==t.indexOf("windows 98")),S=-1!==t.indexOf("winnt")||-1!==t.indexOf("windows nt"),v=(f||S||g||4<=r&&"Win32"===navigator.platform||-1!==t.indexOf("win32")||t.indexOf("32bit"),4<=r&&"Win64"===navigator.platform||4<=r&&"wow64"===navigator.platform||-1!==t.indexOf("wow64")||-1!==t.indexOf("x64")||-1!==t.indexOf("win64")||t.indexOf("64bit"),-1===t.indexOf("os/2")&&-1===navigator.appVersion.indexOf("OS/2")&&t.indexOf("ibm-webexplorer"),-1!==t.indexOf("mac")),x=(v&&/os x (\d{1}[\._]|10[\._][0-5])/.test(t),!v||-1===t.indexOf("68k")&&t.indexOf("68000"),!v||-1===t.indexOf("ppc")&&t.indexOf("powerpc"),-1!==t.indexOf("sunos")),m=(t.indexOf("sunos 4"),t.indexOf("sunos 5"),x&&t.indexOf("i86"),t.indexOf("irix"),t.indexOf("irix 5"),-1===t.indexOf("irix 6")&&t.indexOf("irix6"),-1!==t.indexOf("hp-ux")),O=(m&&t.indexOf("09."),m&&t.indexOf("10."),t.indexOf("aix"),t.indexOf("aix 1"),t.indexOf("aix 2"),t.indexOf("aix 3"),t.indexOf("aix 4"),t.indexOf("inux"),-1===t.indexOf("sco")&&t.indexOf("unix_sv"),t.indexOf("unix_system_v"),t.indexOf("ncr"),t.indexOf("reliantunix"),-1===t.indexOf("dec")&&-1===t.indexOf("osf1")&&-1===t.indexOf("dec_alpha")&&-1===t.indexOf("alphaserver")&&-1===t.indexOf("ultrix")&&t.indexOf("alphastation"),t.indexOf("sinix"),t.indexOf("freebsd"),t.indexOf("bsd"),t.indexOf("x11"),-1===t.indexOf("vax")&&t.indexOf("openvms"),o||C||i||c||d||s?this.errorCodeOK:this.errorCodeUnsupportedBrowser);e(O)},CCPConfigurationVerifierLib.prototype.compareVersions=function(e,t,r){var o,s,i,n,a,c,l,u=0;for("string"==typeof t?o=t:-1!==r[0].toLowerCase().indexOf("win")&&-1!==r[2].toLowerCase().indexOf("i386")?o=t.ver_win32:-1!==r[0].toLowerCase().indexOf("linux")&&-1!==r[2].toLowerCase().indexOf("i386")?o=t.ver_lin32:-1!==r[0].toLowerCase().indexOf("linux")&&-1!==r[2].toLowerCase().indexOf("64")?o=t.ver_lin64:-1!==r[0].toLowerCase().indexOf("darwin")&&-1!==r[2].toLowerCase().indexOf("64")&&(o=t.ver_osx64),s=e.split("-"),i=o.split("-"),c=0;c<s.length;c+=1){for(n=s[c].split("."),a=i[c].split("."),l=0;l<n.length;l+=1){if(parseInt(n[l],10)>parseInt(a[l],10)){u=0;break}if(parseInt(n[l],10)<parseInt(a[l],10)){u=1;break}}if(0!==u)break}return u},CCPConfigurationVerifierLib.prototype.isCCPInstalledAndSupported=function(o,s){var i,n=this;this.getServerVersion(function(e){var r=e.split(n.resultDelimiter);0===parseInt(r[0],10)?n.getArchType(function(e){var t,e=n.getModuleCore().convertResultToObject(e.substring(e.indexOf(n.resultDelimiter)+1));e.resultCode===n.getModuleCore().httpOK?((t=[]).push(e.kernelType),t.push(e.kernelVersion),t.push(e.buildArchitecture),i=0===n.compareVersions(r[1],o,t)?n.errorCodeOK:n.errorCodeNeedUpdate,s(i)):s(n.errorCodeNeedUpdate)}):s(r[0])})},CCPConfigurationVerifierLib.prototype.isModuleInstalledAndSupported=function(o,s){var i=this;this.getArchType(function(e){var r=i.getModuleCore().convertResultToObject(e.substring(e.indexOf(i.resultDelimiter)+1));r.resultCode===i.getModuleCore().httpOK?i.getModuleVersion(function(e){var e=e.split(i.resultDelimiter),t=0===parseInt(e[0],10)?((t=[]).push(r.kernelType),t.push(r.kernelVersion),t.push(r.buildArchitecture),0===i.compareVersions(e[1],o,t)?i.errorCodeOK:i.errorCodeNeedUpdate):e[0];s(t)}):s(r[0])})},CCPConfigurationVerifierLib.prototype.verifyCCPConfiguration=function(t,r,o,s,i){var n=this;this.isBrowserSupported(function(e){e===n.errorCodeOK?n.isCCPInstalledAndSupported(t,function(e){e===n.errorCodeOK?n.isModuleInstalledAndSupported(r,function(e){e===n.errorCodeOK?i(n.errorCodeOK):n.doUpdate(o,s,function(e){parseInt(e.split(n.resultDelimiter)[0],10)===n.errorCodeOK?n.isModuleInstalledAndSupported(r,function(e){e===n.errorCodeOK?i(n.errorCodeOK):i(n.errorCodeNeedRelogin)}):i(n.errorCodeUpdateFailed)})}):i(e)}):i(e)})},SignLibPekao.prototype=Object.create(CCPConfigurationVerifierLib.prototype),(SignLibPekao.prototype.constructor=SignLibPekao).prototype.getModuleCore=function(){return this.pekaoModuleCore},SignLibPekao.prototype.mapStatusCode=function(e,t){t={200:t.errorCodeOK,202:t.errorCodeOK,400:1,403:1,404:1,418:1,419:1,500:51,503:51,0:t.errorCodeOK,41:8,42:66,43:43,44:34,45:9,46:91,47:32774,48:1,49:33,50:48,51:51,55:130,56:56,57:4,58:6,59:7,60:64,61:131,31:-1,34:1,37:1}[e];return t=void 0===t?e:t},SignLibPekao.prototype.getModuleVersion=function(e){this.cover.coverPage();var e=this.getInnerCallback(e),t={cmd:"GetModuleVersion",params:{}};this.getModuleCore().prepareAndCallAjax(t,e)},SignLibPekao.prototype.changePin=function(e){this.cover.coverPage();var e=this.getInnerCallback(e),t={};this.isFullScreenSuported()?(t.cmd="ChangePin",t.params={},this.getModuleCore().prepareAndCallAjax(t,e)):e(ccp_getFullScreenNotSupportedError())},SignLibPekao.prototype.changePuk=function(e){this.cover.coverPage();var e=this.getInnerCallback(e),t={};this.isFullScreenSuported()?(t.cmd="ChangePuk",t.params={},this.getModuleCore().prepareAndCallAjax(t,e)):e(ccp_getFullScreenNotSupportedError())},SignLibPekao.prototype.generateKey=function(e,t){this.cover.coverPage();var t=this.getInnerCallback(t),r={};this.isFullScreenSuported()?(r.cmd="GenerateKey",r.params={},this.getModuleCore().isEmpty(e)?t(ccp_getNoDataError()):(e=e.replace(/\|/g,""),r.params.minLength=e,this.getModuleCore().prepareAndCallAjax(r,t))):t(ccp_getFullScreenNotSupportedError())},SignLibPekao.prototype.generateNewRequest=function(e,t){this.cover.coverPage();var t=this.getInnerCallback(t),r={};this.isFullScreenSuported()?(r.cmd="GenerateNewRequest",r.params={},this.getModuleCore().isEmpty(e)?t(ccp_getNoDataError()):(r.params.commonName=e,this.getModuleCore().prepareAndCallAjax(r,t))):t(ccp_getFullScreenNotSupportedError())},SignLibPekao.prototype.generateRequest=function(e){this.cover.coverPage();var e=this.getInnerCallback(e),t={cmd:"GenerateRequest",params:{}};this.getModuleCore().prepareAndCallAjax(t,e)},SignLibPekao.prototype.initializeCard=function(e){this.cover.coverPage();var e=this.getInnerCallback(e),t={};this.isFullScreenSuported()?(t.cmd="InitializeCard",t.params={},this.getModuleCore().prepareAndCallAjax(t,e)):e(ccp_getFullScreenNotSupportedError())},SignLibPekao.prototype.insertCertificate=function(e,t,r,o,s,i,n){this.cover.coverPage();var n=this.getInnerCallback(n),a={};this.getModuleCore().isEmpty(e)||this.getModuleCore().isEmpty(t)||this.getModuleCore().isEmpty(r)||this.getModuleCore().isEmpty(o)||this.getModuleCore().isEmpty(s)||this.getModuleCore().isEmpty(i)?n(ccp_getNoDataError()):(a.cmd="InsertCertificate",a.params={},a.params.newCertificate=e,a.params.oldKeyName=t,a.params.oldDigest=r,a.params.oldCertificate=o,a.params.newKeyName=s,a.params.newDigest=i,this.getModuleCore().prepareAndCallAjax(a,n))},SignLibPekao.prototype.insertNewCertificate=function(e,t,r){this.cover.coverPage();var r=this.getInnerCallback(r),o={};this.getModuleCore().isEmpty(e)||this.getModuleCore().isEmpty(t)?r(ccp_getNoDataError()):(o.cmd="InsertNewCertificate",o.params={},o.params.certificate=e,o.params.digest=t,this.getModuleCore().prepareAndCallAjax(o,r))},SignLibPekao.prototype.registerCert=function(e){this.cover.coverPage();var e=this.getInnerCallback(e),t={};this.isFullScreenSuported()?(t.cmd="RegisterCert",t.params={},this.getModuleCore().prepareAndCallAjax(t,e)):e(ccp_getFullScreenNotSupportedError())},SignLibPekao.prototype.setKey=function(e,t,r,o,s){var i,n;this.cover.coverPage(),s=this.getInnerCallback(s),i="key"+e,(n={}).keyId=e,n.keyName=t,n.keyValue=r,n.keyLocation=o,e=this.getModuleCore().objectToJsonString(n),this.getModuleCore().setSessionVar(i,e,s)},SignLibPekao.prototype.sign=function(e,t,r,o,s){this.cover.coverPage();var s=this.getInnerCallback(s),i={};this.isFullScreenSuported()?(i.cmd="Sign",i.params={},this.getModuleCore().isEmpty(e)||this.getModuleCore().isEmpty(r)?s(ccp_getNoDataError()):(i.params.keysId=e,i.params.defKeyId=t,i.params.data=r,i.params.useSMSCode=o,this.getModuleCore().prepareAndCallAjax(i,s))):s(ccp_getFullScreenNotSupportedError())},SignLibPekao.prototype.unblockCard=function(e){this.cover.coverPage();var e=this.getInnerCallback(e),t={};this.isFullScreenSuported()?(t.cmd="UnblockCard",t.params={},this.getModuleCore().prepareAndCallAjax(t,e)):e(ccp_getFullScreenNotSupportedError())},SignLibPekao.prototype.beginSession=function(e,t,o,s){var i=this.getModuleCore(),n=this;i.setSessionVar("ssn_id",e,function(r){i.setSessionVar("logging_type",t,function(t){i.setSessionVar("sms_code_no",o,function(e){parseInt((""+r).split(n.resultDelimiter)[0],10)===n.errorCodeOK?parseInt((""+t).split(n.resultDelimiter)[0],10)===n.errorCodeOK?s(e):s(t):s(r)})})})},SignLibPekao.prototype.testConnectionStatus=function(e){this.pekaoModuleCore.testConnectionStatus(e)},SignLibPekao.prototype.checkPrivateNetworkAccess=function(){return this.pekaoModuleCore.checkPrivateNetworkAccess()};var CCPPekaoInstance=new SignLibPekao;